<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arulmigu Narayana Swamy Temple - Donation Portal (Cloud) v3</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+Tamil:wght@400;700&display=swap" rel="stylesheet">
  <style>
    
    body { font-family: 'Inter', sans-serif; }
    [lang="ta"] body, [lang="ta"] button, [lang="ta"] input, [lang="ta"] textarea, [lang="ta"] h1, [lang="ta"] h2, [lang="ta"] p, [lang="ta"] label { font-family: 'Noto Sans Tamil', sans-serif; }
    .glass-card { background: rgba(255,255,255,0.75); backdrop-filter: blur(8px); border-radius: 12px; padding: 1.25rem; box-shadow: 0 6px 18px rgba(0,0,0,0.12); }
    .no-scrollbar::-webkit-scrollbar { display:none; } .no-scrollbar { -ms-overflow-style:none; scrollbar-width:none; }
    @media print {
      body * { visibility: visible; }
    }
    <style>
  body { font-family: 'Inter', sans-serif; }
  [lang="ta"] body, [lang="ta"] button, [lang="ta"] input, [lang="ta"] textarea, 
  [lang="ta"] h1, [lang="ta"] h2, [lang="ta"] p, [lang="ta"] label { 
      font-family: 'Noto Sans Tamil', sans-serif; 
  }
  .glass-card { 
      background: rgba(255,255,255,0.75); 
      backdrop-filter: blur(8px); 
      border-radius: 12px; 
      padding: 1.25rem; 
      box-shadow: 0 6px 18px rgba(0,0,0,0.12); 
  }
  .no-scrollbar::-webkit-scrollbar { display:none; } 
  .no-scrollbar { -ms-overflow-style:none; scrollbar-width:none; }

  /* ğŸ”¥ MOVE THIS HERE (correct place) */
  @media print {

    nav,
    #scan-to-pay,
    #home-page,
    #photos-page,
    #events-page,
    #templeinfo-page,
    #password-modal,
    #donor-tab,
    #photo-tab,
    #event-tab,
    #templeinfo-tab,
    #print-btn,
    #export-btn,
    .delete-donation,
    .delete-event,
    .edit-info,
    .delete-info,
    .no-print {
      display: none !important;
      visibility: hidden !important;
    }

    header, footer {
      display: block !important;
      visibility: visible !important;
      position: relative !important;
    }

    #admin-view,
    #donor-content,
    #donor-count,
    table {
      display: block !important;
      visibility: visible !important;
    }

    table {
      width: 100% !important;
      border-collapse: collapse !important;
    }

    th:last-child,
    td:last-child {
      display: none !important;
    }
  }
</style>

  </style>
</head>
<body class="bg-orange-50 min-h-screen">

<div id="app" class="max-w-6xl mx-auto p-6">
  <header class="mb-6">
    <div class="header-image bg-[url('https://placehold.co/1200x200/E67E22/FFFFFF?text=-')] bg-cover bg-center h-40 rounded-lg relative">
      <div class="absolute inset-0 bg-black/0 flex items-center justify-center rounded-lg">
        <h2 id="header-title" class="text-white text-1xl md:text-4xl font-bold"><center>Arulmigu Narayana Swamy Temple Donation Portal </center></h2>
      </div>
    </div>
  </header>

  <nav class="mb-6 flex justify-between items-center no-print">
    <div class="flex gap-2">
      <button id="en-lang-btn" class="px-6 py-3 bg-orange-500 text-white rounded-md">English</button>
      <button id="ta-lang-btn" class="px-6 py-3 bg-green-600 text-white rounded-md">à®¤à®®à®¿à®´à¯</button>
    </div>
    <div>
      <a href="#" id="admin-login-link" class="text-sm font-medium text-orange-700">Admin Login</a>
    </div>
  </nav>

  <main>

<!-- Scan to Pay -->
<div id="scan-to-pay" class="glass-card p-6 md:p-8 text-center">
  <h3 class="text-xl font-bold mb-2" data-key="paymentTitle">Scan to Pay</h3>
  <img src="QR.png" class="mx-auto rounded-lg shadow-lg w-80 h-auto" />
  <p class="mt-3 text-sm" data-key="paymentInstructions">After payment, enter the UPI transaction ID in the form.<p>à®ªà®£à®®à¯ à®šà¯†à®²à¯à®¤à¯à®¤à®¿à®¯ à®ªà®¿à®±à®•à¯, à®ªà®Ÿà®¿à®µà®¤à¯à®¤à®¿à®²à¯ UPI à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®à®Ÿà®¿à®¯à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯.</p></p>
</div>

<!-- HOME PAGE -->
<div id="home-page">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-6">

    <!-- Donation Form -->
    <section class="glass-card">
      <h2 class="text-2xl font-bold mb-4" data-key="donationTitle">Make a Donation</h2>

      <form id="donation-form" class="space-y-3">

        <div><label data-key="donorName">Donor Name</label>
          <input id="donorName" required class="w-full p-2 border rounded-md" /></div>

        <div><label data-key="address">Address</label>
          <textarea id="address" rows="2" class="w-full p-2 border rounded-md"></textarea></div>

        <div><label data-key="phone">Phone Number</label>
          <input id="phone" class="w-full p-2 border rounded-md" /></div>

        <div><label data-key="email">Email</label>
          <input id="email" class="w-full p-2 border rounded-md" /></div>

        <div>
  <label data-key="amount">Amount (â‚¹)</label>
  <input id="amount" type="number" min="1" required class="w-full p-2 border rounded-md" />
</div>

<div>
  <label data-key="transactionId">UPI Transaction ID</label>
  <input id="transactionId" class="w-full p-2 border rounded-md" />
</div>

      <!--  <div><label>UPI Transaction ID</label>
          <input id="transactionId" class="w-full p-2 border rounded-md" /></div> -->

        <div><label data-key="date">Date</label>
          <input id="donationDate" type="date" class="w-full p-2 border rounded-md" /></div>

        <button class="w-full bg-green-600 text-white py-4 rounded-lg">Submit Donation</button>
      </form>
    </section>

    <!-- Explore More 3x2 Layout -->
    <div class="glass-card">
     <h3 class="text-xl font-bold mb-2" data-key="explore">Explore More</h3>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">

        <button id="go-to-photos-btn" class="py-5 rounded-lg bg-orange-500 text-white text-lg" data-key="templePhotos">ğŸ–¼ï¸Temple PhotosğŸ“¸</button>
        <button id="go-to-events-btn" class="py-5 rounded-lg bg-orange-500 text-white text-lg" data-key="specialDays">âœ¨ Special DaysğŸª”</button>

        <button id="go-to-templeinfo-btn" class="py-5 rounded-lg bg-pink-600 text-white text-lg" data-key="templeInfoBtn">â˜ Temple Info & ContactğŸ“</button>
        <button id="go-to-youtube-btn" class="py-5 rounded-lg bg-red-600 text-white text-lg">â–¶ YouTube</button>

        <button id="go-to-facebook-btn" class="py-5 rounded-lg bg-blue-700 text-white text-lg">ğŸ“˜ Facebook</button>
        <button id="go-to-instagram-btn" class="py-5 rounded-lg bg-gradient-to-r from-purple-500 via-pink-500 to-yellow-400 text-white text-lg">ğŸ“¸ Instagram</button>

      </div>
    </div>

  </div>
</div>

<!-- PHOTOS PAGE -->
<div id="photos-page" class="hidden">
  <div class="glass-card">
    <div class="flex justify-between">
      <h2 class="text-2xl font-bold">Temple Photos</h2>
      <button class="back-home bg-gray-500 text-white px-3 py-2 rounded">Back</button>
    </div>

    <div id="main-gallery" class="mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
  </div>
</div>

<!-- EVENTS PAGE -->
<div id="events-page" class="hidden">
  <div class="glass-card">
    <div class="flex justify-between">
      <h2 class="text-2xl font-bold">Special Days</h2>
      <button class="back-home bg-gray-500 text-white px-3 py-2 rounded">Back</button>
    </div>

    <div id="main-events" class="space-y-3 mt-4"></div>
  </div>
</div>

<!-- TEMPLE INFO PAGE (User View Only) -->
<div id="templeinfo-page" class="hidden">
  <div class="glass-card">
    <div class="flex justify-between">
      <h2 class="text-2xl font-bold">Temple Info & Contacts</h2>
      <button class="back-home bg-gray-500 text-white px-3 py-2 rounded">Back</button>
    </div>

    <div class="mt-4 space-y-3">
      <p id="info-phone" class="p-3 border rounded bg-white shadow"></p>
    <a id="info-youtube" target="_blank" class="block p-3 border rounded bg-white shadow text-red-600"></a>
<a id="info-facebook" target="_blank" class="block p-3 border rounded bg-white shadow text-blue-700"></a>
<a id="info-instagram" target="_blank" class="block p-3 border rounded bg-white shadow text-pink-600"></a>
    </div>
  </div>
</div>


<!-- ADMIN PANEL -->
<div id="admin-view" class="hidden">
  <div class="glass-card mt-6">

    <div class="flex justify-between">
      <h2 class="text-xl font-bold">Admin Dashboard</h2>
      <button id="logout-btn" class="bg-red-500 text-white px-3 py-2 rounded">Logout</button>
    </div>

    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mt-4 border-b pb-3">
      <button id="donor-tab" class="px-3 py-2 bg-orange-100 text-orange-700 rounded">ğŸ“—Donors</button>
      <button id="photo-tab" class="px-3 py-2 rounded">ğŸ–¼ï¸PhotosğŸ“¸</button>
      <button id="event-tab" class="px-3 py-2 rounded">ğŸª”Events</button>
      <button id="templeinfo-tab" class="px-3 py-2 rounded">ğŸ“°Temple Info</button>
    </div>

    <!-- DONOR CONTENT -->
<div id="donor-content">

<div class="my-3">
  <h3 class="font-semibold mb-2">Donor ListğŸ“ƒ</h3>

  <div class="flex flex-wrap gap-2 text-sm w-full">
    <!-- buttons stay same -->

  <!-- Name -->
  <button id="sort-name-asc" class="px-2 py-1 bg-orange-100 rounded">A â†’ Z</button>
  <button id="sort-name-desc" class="px-2 py-1 bg-orange-100 rounded">Z â†’ A</button>

  <!-- Date -->
  <button id="sort-date-new" class="px-2 py-1 bg-orange-100 rounded">New â†’ Old</button>
  <button id="sort-date-old" class="px-2 py-1 bg-orange-100 rounded">Old â†’ New</button>

  <!-- Amount -->
  <button id="sort-amount-asc" class="px-2 py-1 bg-orange-100 rounded">â‚¹ Low â†’ High</button>
  <button id="sort-amount-desc" class="px-2 py-1 bg-orange-100 rounded">â‚¹ High â†’ Low</button>

  <!-- Export -->
  <button id="export-btn" class="px-2 py-1 bg-green-200 rounded font-semibold">Export</button>

  <!-- Print -->
  <button id="print-btn" class="px-2 py-1 bg-blue-200 rounded font-semibold">Print</button>

</div>
</div>

<p id="donor-count" class="text-sm text-gray-600 mb-2"></p>
<div class="overflow-x-auto">
  <table class="min-w-full text-sm mt-2 border">
  <thead>
    <tr class="bg-orange-200">
      <th class="border p-2">#</th>
      <th class="border p-2">Donor</th>
      <th class="border p-2">Date</th>
      <th class="border p-2">Phone</th>
      <th class="border p-2">Amount</th>
      <th class="border p-2">Txn ID</th>
      <th class="border p-2">Action</th>
    </tr>
  </thead>

  <tbody id="donors-table-body"></tbody>
</table>
  </div>

</div> <!-- END donor-content -->


<!-- PHOTO CONTENT -->
<div id="photo-content" class="hidden">
  <h3 class="font-semibold my-3">Upload Photos</h3>
  <form id="photo-upload-form" class="flex gap-3">
    <input id="photoFile" type="file" class="border p-2 rounded" />
    <button class="bg-orange-500 text-white px-4 py-2 rounded">Upload</button>
  </form>
</div>

<!-- EVENT CONTENT -->
<div id="event-content" class="hidden">
  <h3 class="font-semibold my-3">Manage Events</h3>
  <form id="event-form" class="space-y-2">
    <input id="eventDate" type="date" class="border p-2 rounded w-full" />
    <textarea id="eventDescription" class="border p-2 rounded w-full"></textarea>
    <button class="bg-orange-500 text-white px-4 py-2 rounded w-full">Add Event</button>
  </form>

  <div id="admin-events-list" class="mt-3 space-y-2"></div>
</div>

<!-- TEMPLE INFO CONTENT -->
<div id="templeinfo-content" class="hidden">
  <h3 class="font-semibold my-3">Temple Info & Contact</h3>
  <form id="templeinfo-form" class="space-y-2">
    <input id="tphone" placeholder="Temple Phone" class="border p-2 rounded w-full" />
    <input id="tyt" placeholder="YouTube Link" class="border p-2 rounded w-full" />
    <input id="tfb" placeholder="Facebook Link" class="border p-2 rounded w-full" />
    <input id="tig" placeholder="Instagram Link" class="border p-2 rounded w-full" />
    <button class="bg-pink-600 text-white px-4 py-2 rounded w-full">Save Temple Info</button>
  </form>

  <div id="templeinfo-list" class="mt-4 space-y-2"></div>
</div>

</main>

<!-- ADMIN LOGIN MODAL -->
<div id="password-modal" class="fixed inset-0 bg-black/50 hidden items-center justify-center">
  <div class="bg-white p-6 rounded max-w-sm w-full">
    <h3 class="text-lg font-bold mb-2">Admin Login</h3>
    <input id="admin-password" type="password" class="w-full border p-2 rounded mb-3" placeholder="Enter password" />
    <div class="flex justify-end gap-2">
      <button id="password-cancel-btn" class="px-4 py-2 bg-gray-300 rounded">Cancel</button>
      <button id="password-submit" class="px-4 py-2 bg-orange-500 text-white rounded">Login</button>
    </div>
  </div>
</div>
  
  <footer class="mt-6 text-center text-sm no-print">&copy; <span id="footer-year"></span> Arulmigu Narayana Swamy Templep<p>Created by AmuthavishnukumaranÂ Srinivasan</p></footer>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- Firebase + App Logic -->
<script type="module">
  // Hide scan to pay when admin logs in
document.getElementById("password-submit").onclick = () => {
  if (document.getElementById("admin-password").value === ADMIN_PASSWORD) {

    document.getElementById("password-modal").classList.add("hidden");

    // âœ¨ Hide scan to pay section
    document.getElementById("scan-to-pay").classList.add("hidden");

    document.getElementById("home-page").classList.add("hidden");
    document.getElementById("admin-view").classList.remove("hidden");
  } else {
    alert("âŒWrong Passwordâ—ğŸ”’");
  }
};

  // ğŸ”¥ STORE LATEST TEMPLE INFO HERE
let latestTempleInfo = {};
  
  /* -------------------------------------------------------
    FIREBASE INITIAL SETUP
-------------------------------------------------------- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
import { getStorage, ref as sref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyC7AcMsWETrrEwQTqVYL_QqFMzepMog",
  authDomain: "donation-portal-f4b2b.firebaseapp.com",
  databaseURL: "https://donation-portal-f4b2b-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "donation-portal-f4b2b",
  storageBucket: "donation-portal-f4b2b.appspot.com",
  messagingSenderId: "1105454748967",
  appId: "1:1105454748967:web:aa9de7408b64d5d8cd28de"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const storage = getStorage(app);

/* -------------------------------------------------------
    PAGE SWITCHER
-------------------------------------------------------- */
  // ---- Correct Date Formatter (dd-mm-yyyy) ----
function formatDate(dateString) {
  if (!dateString) return "";
  const parts = dateString.split("-");
  if (parts.length !== 3) return dateString;
  return `${parts[2]}-${parts[1]}-${parts[0]}`;
}

function showPage(target) {
  ["home-page", "photos-page", "events-page", "templeinfo-page"].forEach(id => {
    document.getElementById(id).classList.add("hidden");
  });
  document.getElementById(target).classList.remove("hidden");
}

document.querySelectorAll(".back-home").forEach(btn =>
  btn.addEventListener("click", () => showPage("home-page"))
);

/* -------------------------------------------------------
    EXPLORE BUTTONS
-------------------------------------------------------- */
document.getElementById("go-to-photos-btn").onclick = () => showPage("photos-page");
document.getElementById("go-to-events-btn").onclick = () => showPage("events-page");
document.getElementById("go-to-templeinfo-btn").onclick = () => showPage("templeinfo-page");

document.getElementById("go-to-youtube-btn").onclick = () => {
  window.open(latestTempleInfo.youtube || "https://youtube.com", "_blank");
};

document.getElementById("go-to-facebook-btn").onclick = () => {
  window.open(latestTempleInfo.facebook || "https://facebook.com", "_blank");
};

document.getElementById("go-to-instagram-btn").onclick = () => {
  window.open(latestTempleInfo.instagram || "https://instagram.com", "_blank");
};

/* -------------------------------------------------------
    DONATION SAVE
-------------------------------------------------------- */
document.getElementById("donation-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const data = {
    donorName: donorName.value,
    address: address.value,
    phone: phone.value,
    email: email.value,
    amount: amount.value,
    transactionId: transactionId.value,
    date: donationDate.value
  };
  await push(ref(db, "donations"), data);
  Swal.fire({
  title: "Thank You! ğŸ™",
  text: "Your donation has been successfully submitted.",
  imageUrl: "https://media.tenor.com/kx02y-HTwW8AAAAj/thank-you.gif",
  imageWidth: 150,
  imageHeight: 150,
  confirmButtonText: "OK",
  confirmButtonColor: "#28a745"
});
  e.target.reset();
});

/* -------------------------------------------------------
    DONOR TABLE + SORTING (FULL WORKING)
-------------------------------------------------------- */

let donorArray = [];

onValue(ref(db, "donations"), snapshot => {
  const data = snapshot.val() || {};

  // Convert Firebase object â†’ Array
  donorArray = Object.keys(data).map(id => ({
    id,
    ...data[id]
  }));

  // Default â†’ latest first
  donorArray.reverse();
  document.getElementById("donor-count").textContent = "Total Donors: " + donorArray.length;

  renderDonorTable(donorArray);
});

function renderDonorTable(list) {
  const tbody = document.getElementById("donors-table-body");
  tbody.innerHTML = "";

  list.forEach((d, index) => {
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="border p-2 font-bold">${index + 1}</td>
      <td class="border p-2">${d.donorName}<br><small>${d.address}</small></td>
      <td class="border p-2">${formatDate(d.date)}</td>
      <td class="border p-2">${d.phone}</td>
      <td class="border p-2">â‚¹${d.amount}</td>
      <td class="border p-2">${d.transactionId}</td>
      <td class="border p-2">
        <button data-id="${d.id}" class="delete-donation bg-red-500 text-white px-2 py-1 rounded">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });

  // DELETE BUTTON EVENTS
  document.querySelectorAll(".delete-donation").forEach(btn => {
    btn.onclick = () => {
      if (confirm("Delete this donation?")) {
        remove(ref(db, "donations/" + btn.dataset.id));
      }
    };
  });
}

/* ---------------- SORT BUTTONS ---------------- */

document.getElementById("sort-name-asc").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => a.donorName.localeCompare(b.donorName));
  renderDonorTable(sorted);
};

document.getElementById("sort-name-desc").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => b.donorName.localeCompare(a.donorName));
  renderDonorTable(sorted);
};

document.getElementById("sort-amount-asc").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => Number(a.amount) - Number(b.amount));
  renderDonorTable(sorted);
};

document.getElementById("sort-amount-desc").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => Number(b.amount) - Number(a.amount));
  renderDonorTable(sorted);
};

  /* ------------ DATE SORTING ---------------- */

document.getElementById("sort-date-new").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => new Date(b.date) - new Date(a.date));
  renderDonorTable(sorted);
};

document.getElementById("sort-date-old").onclick = () => {
  let sorted = [...donorArray].sort((a, b) => new Date(a.date) - new Date(b.date));
  renderDonorTable(sorted);
};

  /* ------------ EXPORT CSV ---------------- */

document.getElementById("export-btn").onclick = () => {
  let csv = "Index,Name,Address,Date,Phone,Amount,TxnID\n";

  donorArray.forEach((d, idx) => {
    csv += `${idx+1},"${d.donorName}","${d.address}",${d.date},${d.phone},${d.amount},${d.transactionId}\n`;
  });

  let blob = new Blob([csv], { type: "text/csv" });
  let link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "Donor_List.csv";
  link.click();
};

  /* ------------ PRINT TABLE ---------------- */

document.getElementById("print-btn").onclick = () => {
  window.print();
};

  
/* -------------------------------------------------------
    PHOTO UPLOAD
-------------------------------------------------------- */
document.getElementById("photo-upload-form").addEventListener("submit", (e) => {
  e.preventDefault();
  const file = document.getElementById("photoFile").files[0];
  if (!file) return alert("Select photo!");

  const storageRef = sref(storage, "photos/" + Date.now() + "_" + file.name);
  const uploadTask = uploadBytesResumable(storageRef, file);

  uploadTask.on("state_changed", null, err => alert(err.message), async () => {
    const url = await getDownloadURL(uploadTask.snapshot.ref);
    await push(ref(db, "photos"), { url });
    alert("Photo Uploaded!");
  });
});

/* LOAD PHOTOS */
onValue(ref(db, "photos"), snapshot => {
  const data = snapshot.val() || {};
  const gallery = document.getElementById("main-gallery");
  gallery.innerHTML = "";

  Object.values(data).forEach(p => {
    let img = document.createElement("img");
    img.src = p.url;
    img.className = "w-full h-48 object-cover rounded shadow";
    gallery.appendChild(img);
  });
});

/* -------------------------------------------------------
    EVENTS
-------------------------------------------------------- */
document.getElementById("event-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const data = {
    date: eventDate.value,
    description: eventDescription.value
  };
  await push(ref(db, "events"), data);
  alert("Event added!");
  e.target.reset();
});

/* LOAD EVENTS */
onValue(ref(db, "events"), snapshot => {
  const data = snapshot.val() || {};
  const list = document.getElementById("main-events");
  const adminList = document.getElementById("admin-events-list");

  list.innerHTML = "";
  adminList.innerHTML = "";

  Object.keys(data).forEach(id => {
    const e = data[id];

    list.innerHTML += `
      <div class="p-3 bg-white/60 rounded">
        <p class="font-bold">${formatDate(e.date)}</p>
        <p>${e.description}</p>
      </div>`;

    adminList.innerHTML += `
      <div class="p-3 bg-white/70 rounded flex justify-between">
        <div><b>${formatDate(e.date)}</b><br>${e.description}</div>
        <button data-id="${id}" class="delete-event bg-red-500 text-white px-3 py-1 rounded">Delete</button>
      </div>`;
  });

  document.querySelectorAll(".delete-event").forEach(btn => {
    btn.onclick = () => {
      if (confirm("Delete event?"))
        remove(ref(db, "events/" + btn.dataset.id));
    };
  });
});

/* -------------------------------------------------------
    TEMPLE INFO (ADMIN ONLY)
-------------------------------------------------------- */

// SAVE TEMPLE INFO
  // SHOW + EDIT + DELETE TEMPLE INFO
onValue(ref(db, "templeInfo"), snapshot => {
  const data = snapshot.val();
  if (!data) return;

  latestTempleInfo = Object.values(data).pop();
  
  const list = document.getElementById("templeinfo-list");
  list.innerHTML = "";

  Object.keys(data).forEach(id => {
    const t = data[id];

    list.innerHTML += `
      <div class="p-3 bg-white/80 rounded shadow flex justify-between items-center">
        <div>
          <p><b>ğŸ“ ${t.phone}</b></p>
          <p>â–¶ ${t.youtube}</p>
          <p>ğŸ“˜ ${t.facebook}</p>
          <p>ğŸ“¸ ${t.instagram}</p>
        </div>

        <div class="flex gap-2">
          <button data-id="${id}" class="edit-info bg-blue-500 text-white px-3 py-1 rounded">Edit</button>
          <button data-id="${id}" class="delete-info bg-red-500 text-white px-3 py-1 rounded">Delete</button>
        </div>
      </div>
    `;
  });

  // DELETE
  document.querySelectorAll(".delete-info").forEach(btn => {
    btn.onclick = () => {
      if (confirm("Delete this Temple Info?")) {
        remove(ref(db, "templeInfo/" + btn.dataset.id));
      }
    };
  });

  // EDIT (Load values back into form)
  document.querySelectorAll(".edit-info").forEach(btn => {
    btn.onclick = () => {
      const t = data[btn.dataset.id];
      tphone.value = t.phone;
      tyt.value = t.youtube;
      tfb.value = t.facebook;
      tig.value = t.instagram;

      alert("Editing mode enabled. Update the fields and press Save Temple Info.");
    };
  });
});
document.getElementById("templeinfo-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const data = {
    phone: tphone.value,
    youtube: tyt.value,
    facebook: tfb.value,
    instagram: tig.value
  };
  await push(ref(db, "templeInfo"), data);
  alert("Temple info updated!");
  e.target.reset();
});

// SHOW TEMPLE INFO PUBLIC
onValue(ref(db, "templeInfo"), snapshot => {
  const data = snapshot.val();
  if (!data) return;

  const last = Object.values(data).pop(); // latest entry

  document.getElementById("info-phone").innerHTML = "ğŸ“ " + last.phone;
  document.getElementById("info-youtube").innerHTML = "â–¶ YouTube";
  document.getElementById("info-youtube").href = last.youtube;

  document.getElementById("info-facebook").innerHTML = "ğŸ“˜ Facebook";
  document.getElementById("info-facebook").href = last.facebook;

  document.getElementById("info-instagram").innerHTML = "ğŸ“¸ Instagram";
  document.getElementById("info-instagram").href = last.instagram;
});

/* -------------------------------------------------------
    ADMIN LOGIN
-------------------------------------------------------- */
const ADMIN_PASSWORD = "password123";

document.getElementById("admin-login-link").onclick = () => {
  document.getElementById("password-modal").classList.remove("hidden");
  document.getElementById("password-modal").classList.add("flex");
};

document.getElementById("password-cancel-btn").onclick = () =>
  document.getElementById("password-modal").classList.add("hidden");

document.getElementById("password-submit").onclick = () => {
  if (document.getElementById("admin-password").value === ADMIN_PASSWORD) {

    document.getElementById("password-modal").classList.add("hidden");

    // âœ¨ Hide scan to pay section
    document.getElementById("scan-to-pay").classList.add("hidden");

    document.getElementById("home-page").classList.add("hidden");
    document.getElementById("admin-view").classList.remove("hidden");
  } else {
    alert("âŒWrong Passwordâ—ğŸ”’");
  }
};


document.getElementById("logout-btn").onclick = () => {
  document.getElementById("admin-view").classList.add("hidden");
  document.getElementById("home-page").classList.remove("hidden");
};

/* -------------------------------------------------------
    ADMIN TAB SWITCHER
-------------------------------------------------------- */
function showAdminTab(tab) {
  ["donor", "photo", "event", "templeinfo"].forEach(id => {
    document.getElementById(id + "-content").classList.add("hidden");
  });
  document.getElementById(tab + "-content").classList.remove("hidden");
}

const tabButtons = {
  donor: document.getElementById("donor-tab"),
  photo: document.getElementById("photo-tab"),
  event: document.getElementById("event-tab"),
  templeinfo: document.getElementById("templeinfo-tab")
};

function setActiveTab(tabName) {
  Object.keys(tabButtons).forEach(name => {
    const btn = tabButtons[name];
    btn.classList.toggle("bg-orange-100", name === tabName);
    btn.classList.toggle("text-orange-700", name === tabName);
    btn.classList.toggle("font-bold", name === tabName);
  });
}

tabButtons.donor.onclick = () => { showAdminTab("donor"); setActiveTab("donor"); };
tabButtons.photo.onclick = () => { showAdminTab("photo"); setActiveTab("photo"); };
tabButtons.event.onclick = () => { showAdminTab("event"); setActiveTab("event"); };
tabButtons.templeinfo.onclick = () => { showAdminTab("templeinfo"); setActiveTab("templeinfo"); };


</script>
  
  <script>
const langData = {
  en: {
    header: "Arulmigu Narayana Swamy Temple Donation Portal",
    paymentTitle: "Scan to Pay",
    paymentInstructions: "After payment, enter the UPI transaction ID in the form.",
    donationTitle: "Make a Donation",
    donorName: "Donor Name",
    address: "Address",
    phone: "Phone Number",
    email: "Email",
    amount: "Amount (â‚¹)",
    transactionId: "UPI Transaction ID",
    date: "Date",
    submit: "Submit Donation",
    explore: "Explore More",
    templePhotos: "ğŸ–¼ Temple Photos",
    specialDays: "âœ¨ Special Days",
    templeInfoBtn: "ğŸ“ Temple Info",
    photosTitle: "Temple Photos",
    eventsTitle: "Special Days",
    templeInfoTitle: "Temple Info & Contacts",
    youtubeBtn: "â–¶ YouTube",
    facebookBtn: "ğŸ“˜ Facebook",
    instagramBtn: "ğŸ“¸ Instagram"
  },

  ta: {
    header: "à®…à®°à¯à®³à¯à®®à®¿à®•à¯ à®¨à®¾à®°à®¾à®¯à®£ à®šà¯à®µà®¾à®®à®¿ à®•à¯‹à®µà®¿à®²à¯ à®¨à®©à¯à®•à¯Šà®Ÿà¯ˆ à®¤à®³à®®à¯",
    paymentTitle: "à®•à®Ÿà¯à®Ÿà®£à®®à¯ à®šà¯†à®²à¯à®¤à¯à®¤ à®¸à¯à®•à¯‡à®©à¯ à®šà¯†à®¯à¯à®¯à®µà¯à®®à¯",
    paymentInstructions: "à®ªà®£à®®à¯ à®šà¯†à®²à¯à®¤à¯à®¤à®¿à®¯ à®ªà®¿à®±à®•à¯, à®ªà®Ÿà®¿à®µà®¤à¯à®¤à®¿à®²à¯ UPI à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®à®Ÿà®¿à®¯à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯.",
    donationTitle: "à®¨à®©à¯à®•à¯Šà®Ÿà¯ˆ à®…à®³à®¿à®•à¯à®•à®µà¯à®®à¯",
    donorName: "à®¤à¯Šà®•à¯ˆ à®µà®´à®™à¯à®•à¯à®ªà®µà®°à¯ à®ªà¯†à®¯à®°à¯",
    address: "à®®à¯à®•à®µà®°à®¿",
    phone: "à®¤à¯Šà®²à¯ˆà®ªà¯‡à®šà®¿ à®à®£à¯",
    email: "à®®à®¿à®©à¯à®©à®à¯à®šà®²à¯",
    amount: "à®¨à®©à¯à®•à¯Šà®Ÿà¯ˆ à®¤à¯Šà®•à¯ˆ (â‚¹)",
    transactionId: "UPI à®ªà®°à®¿à®µà®°à¯à®¤à¯à®¤à®©à¯ˆ à®à®Ÿà®¿",
    date: "à®¤à¯‡à®¤à®¿",
    submit: "à®¨à®©à¯à®•à¯Šà®Ÿà¯ˆ à®šà®®à®°à¯à®ªà¯à®ªà®¿à®•à¯à®•à®µà¯à®®à¯",
    explore: "à®®à¯‡à®²à¯à®®à¯ à®ªà®¾à®°à¯à®•à¯à®•",
    templePhotos: "ğŸ–¼ à®•à¯‹à®µà®¿à®²à¯ à®ªà¯à®•à¯ˆà®ªà¯à®ªà®Ÿà®™à¯à®•à®³à¯",
    specialDays: "âœ¨ à®šà®¿à®±à®ªà¯à®ªà¯ à®¨à®¾à®Ÿà¯à®•à®³à¯",
    templeInfoBtn: "ğŸ“ à®•à¯‹à®µà®¿à®²à¯ à®¤à®•à®µà®²à¯",
    photosTitle: "à®•à¯‹à®µà®¿à®²à¯ à®ªà¯à®•à¯ˆà®ªà¯à®ªà®Ÿà®™à¯à®•à®³à¯",
    eventsTitle: "à®šà®¿à®±à®ªà¯à®ªà¯ à®¨à®¾à®Ÿà¯à®•à®³à¯",
    templeInfoTitle: "à®•à¯‹à®µà®¿à®²à¯ à®¤à®•à®µà®²à¯ & à®¤à¯Šà®Ÿà®°à¯à®ªà¯",
    youtubeBtn: "â–¶ à®¯à¯‚à®Ÿà®¿à®¯à¯‚à®ªà¯",
    facebookBtn: "ğŸ“˜ à®ªà¯‡à®¸à¯à®ªà¯à®•à¯",
    instagramBtn: "ğŸ“¸ à®‡à®©à¯à®¸à¯à®Ÿà®¾à®•à®¿à®°à®¾à®®à¯"
  }
};

function applyLanguage(lang) {
  document.documentElement.lang = lang;

  document.querySelectorAll("[data-key]").forEach(el => {
    const key = el.getAttribute("data-key");
    if (langData[lang][key]) {
      el.textContent = langData[lang][key];
    }
  });

  document.getElementById("header-title").textContent = langData[lang].header;
}

document.getElementById("en-lang-btn").addEventListener("click", () => applyLanguage("en"));
document.getElementById("ta-lang-btn").addEventListener("click", () => applyLanguage("ta"));

applyLanguage("en");
</script>


